<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BankApp">

    <title>Face ID Unlock</title>

    <style>
        /* --- 1. Setup & Variables --- */
        :root {
            --ios-green: #2ed158; /* The specific bright green from your video */
            --island-bg: #000000;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #121212; /* Dark mode background */
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
            color: white;
        }

        /* --- 2. Main Content (Blurred when locked) --- */
        .main-app-content {
            padding-top: calc(60px + env(safe-area-inset-top)); /* Space for dynamic island */
            padding-left: 20px;
            padding-right: 20px;
            height: 100%;
            box-sizing: border-box;
            background: #1c1c1e;
            transition: filter 0.4s ease, transform 0.4s ease;
            transform-origin: center center;
        }

        /* Locked State: Blur and slight scale down */
        body.locked .main-app-content {
            filter: blur(12px) brightness(0.8);
            transform: scale(0.96);
            pointer-events: none;
        }

        /* --- 3. The Dynamic Island Overlay --- */
        #island-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 9999;
            padding-top: 11px; /* Approximate position below bezel */
            pointer-events: none;
        }

        /* The Black Pill Container */
        .dynamic-island {
            background-color: var(--island-bg);
            border-radius: 30px; /* Fully rounded pill */
            width: 0px; /* Starts invisible */
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;

            /* Shadows to match depth */
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);

            /* Transitions for the smooth expansion */
            transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1),
            height 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
        }

        /* Active State: Expanded */
        body.locked .dynamic-island {
            width: 160px; /* Width of the Face ID prompt */
            height: 160px; /* Square shape for the prompt */
            border-radius: 40px; /* Slightly squarer corners when expanded */
            pointer-events: auto;
        }

        /* --- 4. The Content Inside the Island --- */
        .island-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.2s ease 0.1s, transform 0.3s ease 0.1s;
        }

        body.locked .island-content {
            opacity: 1;
            transform: scale(1);
        }

        /* --- 5. Icons (Face ID & Checkmark) --- */
        .icon-container {
            width: 60px;
            height: 60px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        svg {
            position: absolute;
            top: 0;
            left: 0;
        }

        /* FACE ID ICON STYLES */
        #face-id-svg {
            stroke: var(--ios-green);
            fill: none;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            opacity: 0;
        }

        /* The spinning animation for the face */
        body.locked #face-id-svg.scanning {
            opacity: 1;
            animation: faceScan 2s infinite linear;
        }

        @keyframes faceScan {
            0% { transform: perspective(400px) rotateY(0deg); }
            25% { transform: perspective(400px) rotateY(30deg); }
            50% { transform: perspective(400px) rotateY(0deg); }
            75% { transform: perspective(400px) rotateY(-30deg); }
            100% { transform: perspective(400px) rotateY(0deg); }
        }

        /* CHECKMARK STYLES */
        #success-svg {
            stroke: var(--ios-green);
            fill: none;
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        #success-svg.visible {
            opacity: 1;
            transform: scale(1);
        }

        /* Text Label */
        .island-text {
            color: white;
            font-family: -apple-system, sans-serif;
            font-size: 16px;
            font-weight: 500;
            letter-spacing: 0.3px;
        }

        /* Utility */
        .hidden { display: none !important; }

    </style>
</head>
<body class="locked"> <div class="main-app-content">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <div style="background: #333; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #aaa;">AM</div>
        <div style="color: white; font-weight: bold;">Earn Â£50</div>
    </div>

    <div style="margin-bottom: 10px; color: #888; font-size: 14px;">Total balance</div>
    <div style="font-size: 32px; font-weight: 700; margin-bottom: 20px; color: white;">
        779,558.01 <span style="font-size: 16px; color: #888;">UAH</span>
    </div>

    <div style="display: flex; gap: 10px; margin-bottom: 30px;">
        <button style="flex: 1; background: var(--ios-green); color: black; border: none; padding: 14px; border-radius: 20px; font-weight: 600; font-size: 16px;">Send</button>
        <button style="flex: 1; background: #333; color: var(--ios-green); border: none; padding: 14px; border-radius: 20px; font-weight: 600; font-size: 16px;">Add money</button>
        <button style="flex: 1; background: #333; color: var(--ios-green); border: none; padding: 14px; border-radius: 20px; font-weight: 600; font-size: 16px;">Request</button>
    </div>

    <div style="background: #2c2c2e; border-radius: 16px; padding: 15px; display: flex; align-items: center; margin-bottom: 10px;">
        <div style="background: #000; width: 40px; height: 40px; border-radius: 50%; margin-right: 15px;"></div>
        <div>
            <div style="font-weight: 600;">USD Account</div>
            <div style="color: #888; font-size: 13px;">$ 16,602.91</div>
        </div>
    </div>

    <p style="text-align: center; color: #555; margin-top: 50px; font-size: 14px;">Switch apps to test Face ID</p>
</div>

<div id="island-overlay">
    <div class="dynamic-island">
        <div class="island-content">
            <div class="icon-container">

                <svg id="face-id-svg" class="scanning" width="50" height="50" viewBox="0 0 50 50">
                    <path d="M14,4 A14,14 0 0,0 4,14" />
                    <path d="M36,4 A14,14 0 0,1 46,14" />
                    <path d="M46,36 A14,14 0 0,1 36,46" />
                    <path d="M4,36 A14,14 0 0,0 14,46" />

                    <path d="M17,20 L17,20" stroke-width="4" />
                    <path d="M33,20 L33,20" stroke-width="4" />

                    <path d="M17,30 Q25,38 33,30" />
                </svg>

                <svg id="success-svg" width="60" height="60" viewBox="0 0 50 50">
                    <circle cx="25" cy="25" r="23" stroke-width="2.5" />
                    <path d="M14 26 L22 34 L36 16" stroke-width="3" />
                </svg>

            </div>
            <div class="island-text" id="status-text">Face ID</div>
        </div>
    </div>
</div>

<script>
  // --- LOGIC ---

  const faceSvg = document.getElementById('face-id-svg');
  const successSvg = document.getElementById('success-svg');
  const statusText = document.getElementById('status-text');

  let isLocked = true;

  // Function to lock the app
  const lockApp = () => {
    if(isLocked) return;
    isLocked = true;
    document.body.classList.add('locked');

    // Reset UI
    faceSvg.classList.add('scanning');
    faceSvg.style.display = 'block';
    successSvg.classList.remove('visible');
    statusText.innerText = "Face ID";
  };

  // Function to run the unlock sequence
  const unlockSequence = () => {
    if(!isLocked) return;

    console.log("Scanning...");

    // 1. Let it scan for 1.2 seconds (Simulating read)
    setTimeout(() => {

      // 2. Show Success
      faceSvg.style.display = 'none'; // Hide face
      successSvg.classList.add('visible'); // Pop checkmark
      // statusText.innerText = "Authorized"; // Optional text change

      // 3. Unlock after short delay
      setTimeout(() => {
        document.body.classList.remove('locked');
        isLocked = false;
      }, 700); // How long the checkmark stays

    }, 1200); // How long the face scans
  };

  // --- LISTENERS ---

  // 1. App Switching (Tab hidden/visible)
  document.addEventListener("visibilitychange", () => {
    if (document.hidden) {
      lockApp();
    } else {
      // When coming back, wait a split second for the expansion animation, then scan
      setTimeout(unlockSequence, 300);
    }
  });

  // 2. iOS Home Screen backgrounding
  window.addEventListener("pagehide", lockApp);

  // 3. Initial Load -> Start Locked, then scan
  window.addEventListener("load", () => {
    // Ensure we are locked initially
    document.body.classList.add('locked');
    isLocked = true;

    // Start scan immediately on load
    setTimeout(unlockSequence, 500);
  });

</script>
</body>
</html>